#include <iostream>
#include <fstream>
#include <math.h>

#include "TH1F.h"
#include "TF1.h"
#include "TLine.h"
#include "TRandom3.h"
#include "TMath.h"
#include <cmath>
#include "TGraphErrors.h"
#include <algorithm>
#include "TCanvas.h"
#include "TFile.h"

// data 3

std::vector<double> r = {500.0, 450.0, 400.0, 350.0, 300.0, 250.0, 230.0, 210.0, 190.0, 170.0, 150.0, 130.0, 110.0, 90.0, 70.0, 50.0, 30.0, 10.0};

std::vector<double> fake1 = {0.000771605, 0, 0, 0, 0, 0, 0.001564945, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
std::vector<double> fake2 = {0, 0, 0, 0, 0, 0, 0, 0.000509165, 0, 0, 0, 0, 0, 0, 0.000768344, 0, 0, 0};
std::vector<double> fake3 = {0, 0, 0, 0.000388048, 0, 0, 0.000382995, 0, 0, 0, 0, 0, 0, 0, 0.001216915, 0.00122737, 0.000623636, 0.000605877};
std::vector<double> fake4 = {0, 0, 0, 0, 0, 0, 0, 0, 0.000309406, 0, 0, 0.000614628, 0, 0, 0, 0, 0, 0};
std::vector<double> fake5 = {0.002023779, 0.001536492, 0.000519886, 0.001025641, 0.001276161, 0.000260417, 0.000255167, 0.000257865, 0, 0, 0, 0, 0.000255624, 0, 0, 0, 0.000253743, 0};
std::vector<double> fake6 = {0.002899844, 0.002617801, 0.002206531, 0.001545936, 0.000669344, 0.001527051, 0.000874891, 0, 0.000217155, 0, 0, 0.000437924, 0.000218245, 0, 0, 0.000218579, 0, 0};
std::vector<double> fake7 = {0.001917913, 0.002487086, 0.002291388, 0.002535101, 0.001163242, 0.001151631, 0.000567752, 0.000574493, 0.000188253, 0.000967492, 0.000975229, 0.000191939, 0, 0.000194363, 0.00038506, 0, 0, 0};
std::vector<double> fake8 = {0.003953249, 0.003635734, 0.003941731, 0.001710571, 0.003081664, 0.00101833, 0.001205234, 0.001007049, 0.000344175, 0.001373862, 0, 0.000674082, 0.000508647, 0.000678771, 0, 0, 0, 0.000170097};
std::vector<double> fake9 = {0.004317656, 0.004157044, 0.002607762, 0.002913217, 0.002460781, 0.000934288, 0.00092564, 0.000924214, 0.001369238, 0.000615195, 0.000306091, 0.000458225, 0.000154012, 0.000155255, 0.000151999, 0, 0, 0};
std::vector<double> fake10 = {0.007412141, 0.004472272, 0.004520796, 0.003842213, 0.003587444, 0.002558526, 0.002807555, 0.001409895, 0.001028278, 0.000637267, 0.000889567, 0.000772897, 0.000519278, 0.000129099, 0, 0, 0.00012809, 0};
std::vector<double> fake11 = {0.007872294, 0.00514392, 0.004728392, 0.004301312, 0.004049912, 0.00296215, 0.003171825, 0.001977153, 0.00154833, 0.000759384, 0.00098082, 0.000221361, 0.000219515, 0.000327118, 0.000109087, 0.000329598, 0, 0};
std::vector<double> fake12 = {0.009458546, 0.009014993, 0.008222583, 0.008925144, 0.005283889, 0.00354814, 0.003091787, 0.003099574, 0.001924557, 0.001241169, 0.001635559, 0.000574053, 0.00086273, 0.00028938, 0.000288323, 9.55475E-05, 0, 0};
std::vector<double> fake13 = {0.01372095, 0.010613712, 0.00836078, 0.007631646, 0.005756508, 0.002461591, 0.003305645, 0.002052335, 0.00210757, 0.002054619, 0.001013856, 0.001622268, 0.000680561, 0.000591966, 0.000255885, 0.000172295, 8.58148E-05, 0};
std::vector<double> fake14 = {0.014951695, 0.014000619, 0.011226386, 0.00970723, 0.005790611, 0.004290201, 0.005264764, 0.00374446, 0.003131683, 0.002383515, 0.000997085, 0.001452155, 0.000686813, 0.000462963, 0.000385267, 7.67519E-05, 7.71188E-05, 0};
std::vector<double> fake15 = {0.020803841, 0.018659465, 0.015189563, 0.011486569, 0.009300912, 0.005693994, 0.004318056, 0.004894368, 0.005181347, 0.003545882, 0.002785343, 0.001548755, 0.001297899, 0.001094691, 0.000794718, 0.000428239, 6.17322E-05, 6.10836E-05};
std::vector<double> fake16 = {0.033610854, 0.023618424, 0.019783156, 0.017302278, 0.014491275, 0.009066694, 0.008519104, 0.006494503, 0.006147856, 0.003922567, 0.002963417, 0.001483755, 0.001333949, 0.001388032, 0.000719609, 0.000255951, 5.10725E-05, 0};
std::vector<double> fake17 = {0.052226814, 0.045714067, 0.036713755, 0.027931671, 0.022790503, 0.015112773, 0.013490725, 0.012701101, 0.009001039, 0.008069142, 0.005327157, 0.004352012, 0.003509855, 0.002068807, 0.001609627, 0.000614793, 0.000153169, 0};
std::vector<double> fake18 = {0.077934759, 0.067304439, 0.056642129, 0.045472775, 0.032750889, 0.023532686, 0.019821423, 0.016532959, 0.014584615, 0.009998457, 0.008224748, 0.005932438, 0.004007645, 0.003263748, 0.002240157, 0.000919399, 0.000490512, 0};
std::vector<double> eff1 = {0.989, 0.987, 0.981, 0.984, 0.981, 0.972, 0.962, 0.972, 0.959, 0.96, 0.934, 0.906, 0.865, 0.814, 0.723, 0.558, 0.305, 0.039};
std::vector<double> eff2 = {0.993, 0.982, 0.983, 0.982, 0.975, 0.976, 0.974, 0.973, 0.958, 0.949, 0.933, 0.902, 0.867, 0.827, 0.704, 0.54, 0.309, 0.053};
std::vector<double> eff3 = {0.988, 0.987, 0.985, 0.98, 0.979, 0.977, 0.972, 0.971, 0.96, 0.958, 0.936, 0.907, 0.869, 0.82, 0.705, 0.561, 0.307, 0.05};
std::vector<double> eff4 = {0.985, 0.988, 0.988, 0.987, 0.98, 0.978, 0.967, 0.966, 0.959, 0.957, 0.94, 0.916, 0.871, 0.805, 0.713, 0.548, 0.329, 0.047};
std::vector<double> eff5 = {0.987, 0.988, 0.984, 0.984, 0.981, 0.973, 0.974, 0.966, 0.96, 0.948, 0.934, 0.911, 0.865, 0.82, 0.708, 0.548, 0.309, 0.042};
std::vector<double> eff6 = {0.988, 0.987, 0.984, 0.981, 0.978, 0.975, 0.979, 0.969, 0.962, 0.959, 0.934, 0.908, 0.873, 0.809, 0.709, 0.558, 0.319, 0.042};
std::vector<double> eff7 = {0.982, 0.986, 0.988, 0.985, 0.981, 0.975, 0.973, 0.964, 0.956, 0.955, 0.934, 0.907, 0.864, 0.808, 0.705, 0.546, 0.316, 0.045};
std::vector<double> eff8 = {0.987, 0.99, 0.984, 0.985, 0.984, 0.975, 0.972, 0.967, 0.955, 0.95, 0.936, 0.91, 0.878, 0.808, 0.704, 0.553, 0.309, 0.041};
std::vector<double> eff9 = {0.986, 0.987, 0.985, 0.981, 0.979, 0.975, 0.971, 0.97, 0.964, 0.951, 0.931, 0.916, 0.872, 0.822, 0.695, 0.553, 0.324, 0.045};
std::vector<double> eff10 = {0.985, 0.984, 0.985, 0.984, 0.981, 0.975, 0.972, 0.97, 0.964, 0.954, 0.933, 0.907, 0.869, 0.81, 0.71, 0.552, 0.322, 0.05};
std::vector<double> eff11 = {0.987, 0.987, 0.986, 0.984, 0.978, 0.975, 0.972, 0.969, 0.962, 0.949, 0.934, 0.912, 0.869, 0.816, 0.708, 0.543, 0.322, 0.049};
std::vector<double> eff12 = {0.987, 0.985, 0.984, 0.984, 0.979, 0.979, 0.973, 0.967, 0.96, 0.946, 0.941, 0.913, 0.872, 0.809, 0.709, 0.547, 0.312, 0.046};
std::vector<double> eff13 = {0.985, 0.987, 0.985, 0.985, 0.981, 0.976, 0.974, 0.968, 0.96, 0.951, 0.938, 0.91, 0.873, 0.813, 0.707, 0.555, 0.315, 0.046};
std::vector<double> eff14 = {0.986, 0.986, 0.985, 0.984, 0.98, 0.974, 0.971, 0.967, 0.962, 0.951, 0.932, 0.909, 0.876, 0.809, 0.712, 0.546, 0.322, 0.047};
std::vector<double> eff15 = {0.986, 0.986, 0.986, 0.983, 0.981, 0.974, 0.972, 0.969, 0.962, 0.952, 0.936, 0.907, 0.871, 0.815, 0.71, 0.552, 0.317, 0.047};
std::vector<double> eff16 = {0.986, 0.985, 0.984, 0.983, 0.981, 0.974, 0.973, 0.969, 0.963, 0.953, 0.934, 0.911, 0.867, 0.813, 0.714, 0.548, 0.322, 0.044};
std::vector<double> eff17 = {0.986, 0.987, 0.985, 0.983, 0.98, 0.976, 0.972, 0.968, 0.964, 0.952, 0.936, 0.911, 0.872, 0.813, 0.708, 0.554, 0.316, 0.045};
std::vector<double> eff18 = {0.987, 0.985, 0.984, 0.982, 0.981, 0.977, 0.973, 0.967, 0.962, 0.953, 0.936, 0.912, 0.869, 0.812, 0.711, 0.55, 0.318, 0.048};

//---------------------------------------------------------------------------------------------------------------------------------------------------------------

// data 3+2

/* std::vector<double> fake1 = {0.001, 0.001, 0.001, 0.001, 0.001, 0.0, 0.001, 0.001, 0.002,0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.002};
std::vector<double> fake2 = {0.001, 0.002, 0.001, 0.001, 0.002, 0.001, 0.0, 0.002, 0.001,0.001, 0.002, 0.002, 0.0, 0.001, 0.001, 0.002, 0.002, 0.006};
std::vector<double> fake3 = {0.003, 0.002, 0.003, 0.001, 0.002, 0.003, 0.001, 0.002, 0.001,0.002, 0.002, 0.005, 0.003, 0.002, 0.002, 0.003, 0.005, 0.009};
std::vector<double> fake4 = {0.004, 0.003, 0.002, 0.002, 0.001, 0.003, 0.003, 0.004, 0.003,0.003, 0.004, 0.002, 0.001, 0.002, 0.003, 0.003, 0.006, 0.008};
std::vector<double> fake5 = {0.003, 0.003, 0.004, 0.005, 0.005, 0.006, 0.003, 0.003, 0.003,0.005, 0.004, 0.002, 0.004, 0.006, 0.004, 0.005, 0.005, 0.014};
std::vector<double> fake6 = {0.005, 0.005, 0.007, 0.005, 0.005, 0.005, 0.005, 0.004, 0.005,0.004, 0.004, 0.006, 0.004, 0.005, 0.004, 0.004, 0.008, 0.016};
std::vector<double> fake7 = {0.007, 0.007, 0.005, 0.006, 0.007, 0.003, 0.005, 0.005, 0.005,0.004, 0.005, 0.003, 0.004, 0.004, 0.005, 0.005, 0.007, 0.018};
std::vector<double> fake8 = {0.011, 0.006, 0.006, 0.007, 0.006, 0.006, 0.007, 0.006, 0.005,0.005, 0.006, 0.005, 0.004, 0.004, 0.005, 0.005, 0.008, 0.02};
std::vector<double> fake9 = {0.008, 0.009, 0.006, 0.006, 0.006, 0.007, 0.006, 0.006, 0.005,0.006, 0.007, 0.004, 0.004, 0.005, 0.007, 0.008, 0.01, 0.022};
std::vector<double> fake10 = {0.011, 0.01, 0.009, 0.008, 0.008, 0.008, 0.006, 0.007, 0.006,0.006, 0.007, 0.007, 0.006, 0.008, 0.009, 0.008, 0.012, 0.025};
std::vector<double> fake11 = {0.014, 0.012, 0.01, 0.011, 0.009, 0.009, 0.008, 0.008, 0.01,0.009, 0.008, 0.009, 0.008, 0.009, 0.01, 0.01, 0.014, 0.03};
std::vector<double> fake12 = {0.015, 0.013, 0.012, 0.013, 0.012, 0.01, 0.011, 0.009, 0.009,0.009, 0.009, 0.009, 0.01, 0.009, 0.009, 0.01, 0.017, 0.033};
std::vector<double> fake13 = {0.015, 0.016, 0.014, 0.015, 0.014, 0.013, 0.013, 0.013, 0.011,0.012, 0.012, 0.011, 0.01, 0.01, 0.011, 0.013, 0.017, 0.037};
std::vector<double> fake14 = {0.019, 0.015, 0.017, 0.013, 0.014, 0.013, 0.015, 0.012, 0.012,0.014, 0.013, 0.012, 0.012, 0.013, 0.011, 0.013, 0.02, 0.042};
std::vector<double> fake15 = {0.021, 0.02, 0.022, 0.019, 0.019, 0.017, 0.017, 0.016, 0.016,0.015, 0.014, 0.015, 0.013, 0.015, 0.015, 0.015, 0.024, 0.049};
std::vector<double> fake16 = {0.028, 0.025, 0.024, 0.024, 0.023, 0.021, 0.02, 0.021, 0.018,0.019, 0.017, 0.018, 0.016, 0.019, 0.019, 0.02, 0.029, 0.053};
std::vector<double> fake17 = {0.04, 0.038, 0.035, 0.033, 0.03, 0.028, 0.028, 0.026, 0.025,0.024, 0.024, 0.022, 0.022, 0.021, 0.024, 0.024, 0.033, 0.065};
std::vector<double> fake18 = {0.051, 0.051, 0.044, 0.039, 0.037, 0.035, 0.032, 0.033, 0.031,0.029, 0.029, 0.029, 0.028, 0.027, 0.029, 0.029, 0.039, 0.074};
std::vector<double> eff1 = {0.977, 0.983, 0.989, 0.983, 0.986, 0.990, 0.987, 0.980, 0.985, 0.983, 0.987, 0.986, 0.988, 0.984, 0.982, 0.976, 0.945, 0.849};
std::vector<double> eff2 = {0.985, 0.988, 0.982, 0.982, 0.990, 0.986, 0.986, 0.987, 0.984, 0.982, 0.986, 0.979, 0.983, 0.983, 0.982, 0.967, 0.943, 0.852};
std::vector<double> eff3 = {0.985, 0.986, 0.985, 0.987, 0.985, 0.983, 0.987, 0.985, 0.985, 0.983, 0.982, 0.982, 0.984, 0.982, 0.975, 0.967, 0.939, 0.846};
std::vector<double> eff4 = {0.983, 0.983, 0.983, 0.986, 0.983, 0.984, 0.980, 0.986, 0.983, 0.982, 0.980, 0.984, 0.986, 0.979, 0.979, 0.968, 0.927, 0.841};
std::vector<double> eff5 = {0.985, 0.987, 0.986, 0.984, 0.983, 0.980, 0.986, 0.985, 0.982, 0.979, 0.982, 0.983, 0.981, 0.978, 0.972, 0.966, 0.941, 0.845};
std::vector<double> eff6 = {0.983, 0.983, 0.981, 0.982, 0.984, 0.984, 0.985, 0.983, 0.980, 0.983, 0.981, 0.980, 0.981, 0.981, 0.977, 0.969, 0.937, 0.845};
std::vector<double> eff7 = {0.983, 0.984, 0.984, 0.984, 0.983, 0.984, 0.981, 0.982, 0.981, 0.982, 0.979, 0.982, 0.982, 0.981, 0.975, 0.966, 0.936, 0.851};
std::vector<double> eff8 = {0.981, 0.982, 0.982, 0.981, 0.983, 0.981, 0.980, 0.982, 0.983, 0.982, 0.981, 0.982, 0.983, 0.982, 0.973, 0.964, 0.938, 0.843};
std::vector<double> eff9 = {0.978, 0.982, 0.979, 0.981, 0.981, 0.982, 0.983, 0.980, 0.983, 0.980, 0.980, 0.983, 0.982, 0.981, 0.973, 0.961, 0.937, 0.850};
std::vector<double> eff10 = {0.978, 0.980, 0.981, 0.980, 0.979, 0.979, 0.984, 0.979, 0.980, 0.983, 0.978, 0.979, 0.978, 0.977, 0.971, 0.967, 0.937, 0.845};
std::vector<double> eff11 = {0.977, 0.976, 0.981, 0.978, 0.981, 0.978, 0.982, 0.977, 0.978, 0.977, 0.978, 0.978, 0.976, 0.976, 0.969, 0.963, 0.937, 0.837};
std::vector<double> eff12 = {0.974, 0.978, 0.979, 0.976, 0.976, 0.978, 0.979, 0.980, 0.979, 0.977, 0.979, 0.979, 0.975, 0.974, 0.970, 0.961, 0.928, 0.837};
std::vector<double> eff13 = {0.977, 0.977, 0.978, 0.977, 0.977, 0.977, 0.975, 0.974, 0.977, 0.975, 0.975, 0.975, 0.974, 0.974, 0.969, 0.960, 0.929, 0.833};
std::vector<double> eff14 = {0.973, 0.975, 0.976, 0.975, 0.976, 0.976, 0.975, 0.975, 0.976, 0.975, 0.976, 0.976, 0.975, 0.971, 0.970, 0.960, 0.928, 0.832};
std::vector<double> eff15 = {0.974, 0.974, 0.973, 0.974, 0.974, 0.974, 0.973, 0.974, 0.973, 0.974, 0.974, 0.972, 0.973, 0.971, 0.966, 0.958, 0.928, 0.828};
std::vector<double> eff16 = {0.968, 0.971, 0.970, 0.970, 0.971, 0.969, 0.971, 0.970, 0.974, 0.969, 0.971, 0.969, 0.972, 0.966, 0.962, 0.954, 0.920, 0.824};
std::vector<double> eff17 = {0.964, 0.963, 0.966, 0.964, 0.966, 0.966, 0.966, 0.966, 0.965, 0.967, 0.966, 0.968, 0.965, 0.963, 0.958, 0.952, 0.919, 0.815};
std::vector<double> eff18 = {0.957, 0.957, 0.957, 0.961, 0.961, 0.962, 0.960, 0.961, 0.961, 0.963, 0.962, 0.961, 0.961, 0.959, 0.957, 0.945, 0.914, 0.812}; */

std::vector<vector<double>> v_eff = {eff1, eff2, eff3, eff4, eff5, eff6, eff7, eff8, eff9, eff10, eff11, eff12, eff13, eff14, eff15, eff16, eff17, eff18};
std::vector<vector<double>> v_fake = {fake1, fake2, fake3, fake4, fake5, fake6, fake7, fake8, fake9, fake10, fake11, fake12, fake13, fake14, fake15, fake16, fake17, fake18};
std::vector<int> gen_trk = {2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 20, 25, 30, 40, 50};

std::vector<double> chi2 = {1000, 500, 400, 300, 200, 100, 75, 50, 25, 10, 5, 1};
std::vector<double> eff = {0.982839, 0.984086, 0.983522, 0.984508, 0.987161, 0.985966, 0.984766, 0.985019, 0.980284, 0.984591, 0.983944, 0.79149};
std::vector<double> fake = {0.00576, 0.006803, 0.006255, 0.004443, 0.00408, 0.006237, 0.00399, 0.004712, 0.00553, 0.003703, 0.003954, 0.020428};


// mappa di conversione tra i:gen_trk
//  0:2 / 1:3 / 2:4 / 3:5 / 4:6 / 5:7 / 6:8 / 7:9 / 8:10 / 9:12 / 10:14 / 11:16 / 12:18 / 13:20 / 14:25 / 15:30 / 16:40 / 17:50

//---------------------------------------------------------------------------------------------------------------------------------------------------------------
/*
void raggio()
{
    int npoints = 18;
    int i = 10;
    std::vector<double> eff = v_eff[i];
    std::vector<double> fake = v_fake[i];

    TCanvas *c1 = new TCanvas("c1", "eff", 200, 10, 700, 500);
    c1->SetGrid();
    TPad *pad1 = new TPad("pad1", "", 0, 0, 1, 1);
    TPad *pad1fake = new TPad("pad2", "", 0, 0, 1, 1);
    pad1fake->SetFillStyle(4000); // will be transparent
    pad1->SetGrid();
    pad1->Draw();
    pad1->cd();

    TGraphErrors *h1 = new TGraphErrors(npoints, r.data(), eff.data(), 0, 0);
    TGraphErrors *h1fake = new TGraphErrors(npoints, r.data(), fake.data(), 0, 0);
    h1->SetMarkerStyle(22);
    h1->SetMarkerColor(kBlue);
    h1->SetMarkerSize(0.9);
    h1->SetMinimum(0.);
    h1->SetMaximum(1.0);
    h1->GetXaxis()->SetTitle("Raggio [#mum]");
    h1->GetYaxis()->SetTitle("reco_real_trk/gen");
    h1->SetTitle(Form("Track per evento: %d", gen_trk[i]));
    h1->Draw("APL");
    pad1->Update();

    c1->cd();

    Double_t ymin1 = 0.;
    // Double_t ymax1 = 1.3 * (*std::max_element(fake.begin(), fake.end()));
    Double_t ymax1 = 0.08;
    Double_t xmin1 = 0.;
    Double_t xmax1 = 550.;
    Double_t dy1 = (ymax1 - ymin1) / 0.8;
    Double_t dx1 = (xmax1 - xmin1) / 0.8;
    pad1fake->Range(xmin1 - 0.1 * dx1, ymin1 - 0.1 * dy1, xmax1 + 0.1 * dx1, ymax1 + 0.1 * dy1);
    pad1fake->Draw();
    pad1fake->cd();
    h1fake->SetMarkerStyle(20);
    h1fake->SetMarkerSize(1);
    h1fake->SetMarkerColor(kRed);
    h1fake->Draw("PL");
    pad1fake->Update();

    // draw axis on the right side of the pad
    TGaxis *axis1 = new TGaxis(xmax1, ymin1, xmax1, ymax1, ymin1, ymax1, 50510, "+L");
    axis1->SetLabelColor(kRed);
    axis1->SetTitle("fake_trk/gen");
    axis1->SetTitleColor(kRed);
    axis1->Draw();
    pad1fake->Update();

    pad1->Update();
    c1->SaveAs(Form("%d.png", gen_trk[i]));
}
*/
void raggio()
{
    int npoints = 12;
    //int i = 10;
    //std::vector<double> eff = v_eff[i];
    //std::vector<double> fake = v_fake[i];

    TCanvas *c1 = new TCanvas("c1", "eff", 200, 10, 700, 500);
    c1->SetGrid();
    TPad *pad1 = new TPad("pad1", "", 0, 0, 1, 1);
    TPad *pad1fake = new TPad("pad2", "", 0, 0, 1, 1);
    pad1fake->SetFillStyle(4000); // will be transparent
    pad1->SetGrid();
    pad1->Draw();
    pad1->cd();

    TGraphErrors *h1 = new TGraphErrors(npoints, chi2.data(), eff.data(), 0, 0);
    TGraphErrors *h1fake = new TGraphErrors(npoints, chi2.data(), fake.data(), 0, 0);
    h1->SetMarkerStyle(22);
    h1->SetMarkerColor(kBlue);
    h1->SetMarkerSize(0.9);
    h1->SetMinimum(0.8);
    h1->SetMaximum(1.0);
    h1->GetXaxis()->SetTitle("#chi2");
    h1->GetYaxis()->SetTitle("reco_real_trk/gen");
    h1->SetTitle("#chi2 estimation on MC model");
    h1->Draw("APL");
    pad1->Update();

    c1->cd();

    Double_t ymin1 = 0.;
    Double_t ymax1 = 0.03;
    Double_t xmin1 = 0.;
    Double_t xmax1 = 1100.;
    Double_t dy1 = (ymax1 - ymin1) / 0.8;
    Double_t dx1 = (xmax1 - xmin1) / 0.8;
    pad1fake->Range(xmin1 - 0.1 * dx1, ymin1 - 0.1 * dy1, xmax1 + 0.1 * dx1, ymax1 + 0.1 * dy1);
    pad1fake->Draw();
    pad1fake->cd();
    h1fake->SetMarkerStyle(20);
    h1fake->SetMarkerSize(1);
    h1fake->SetMarkerColor(kRed);
    h1fake->Draw("PL");
    pad1fake->Update();

    // draw axis on the right side of the pad
    TGaxis *axis1 = new TGaxis(xmax1, ymin1, xmax1, ymax1, ymin1, ymax1, 50510, "+L");
    axis1->SetLabelColor(kRed);
    axis1->SetTitle("fake_trk/gen");
    axis1->SetTitleColor(kRed);
    axis1->Draw();
    pad1fake->Update();

    pad1->Update();
    //c1->SaveAs(Form("%d.png", gen_trk[i]));
}



void raggio_all()
{
    const int npoints = r.size();
    for (size_t i = 0; i < gen_trk.size(); ++i)
    {
        // Estrai i dati
        auto &eff = v_eff[i];
        auto &fake = v_fake[i];
        int nt = gen_trk[i];

        // Canvas e pad
        TCanvas *c1 = new TCanvas(Form("c%d", nt),
                                  Form("eff_%d", nt),
                                  200, 10, 700, 500);
        c1->SetGrid();

        TPad *pad1 = new TPad("pad1", "", 0, 0, 1, 1);
        TPad *pad1fake = new TPad("pad2", "", 0, 0, 1, 1);
        pad1->SetGrid();
        pad1fake->SetFillStyle(4000);
        pad1->Draw();
        pad1->cd();

        // Primo grafico
        TGraphErrors *h1 = new TGraphErrors(npoints, r.data(), eff.data(), nullptr, nullptr);
        h1->SetMarkerStyle(22);
        h1->SetMarkerColor(kBlue);
        h1->SetMarkerSize(0.9);
        h1->SetMinimum(0.);
        h1->SetMaximum(1.0);
        h1->GetXaxis()->SetTitle("Raggio [#mum]");
        h1->GetYaxis()->SetTitle("reco_real_trk/gen");
        h1->SetTitle(Form("Track per evento: %d", nt));
        h1->Draw("APL");
        pad1->Update();

        // Torno al canvas principale
        c1->cd();

        // Secondo grafico (fake) con asse a destra
        Double_t ymin1 = 0.;
        Double_t ymax1 = 0.08;
        Double_t xmin1 = 0.;
        Double_t xmax1 = 550.;
        Double_t dy1 = (ymax1 - ymin1) / 0.8;
        Double_t dx1 = (xmax1 - xmin1) / 0.8;

        pad1fake->Range(xmin1 - 0.1 * dx1,
                        ymin1 - 0.1 * dy1,
                        xmax1 + 0.1 * dx1,
                        ymax1 + 0.1 * dy1);
        pad1fake->Draw();
        pad1fake->cd();

        TGraphErrors *h1fake = new TGraphErrors(npoints, r.data(), fake.data(), nullptr, nullptr);
        h1fake->SetMarkerStyle(20);
        h1fake->SetMarkerColor(kRed);
        h1fake->Draw("PL");
        pad1fake->Update();

        TGaxis *axis1 = new TGaxis(xmax1, ymin1, xmax1, ymax1,
                                   ymin1, ymax1, 50510, "+L");
        axis1->SetLabelColor(kRed);
        axis1->SetTitle("fake_trk/gen");
        axis1->SetTitleColor(kRed);
        axis1->Draw();
        pad1fake->Update();

        // Salvataggio con nome dinamico
        c1->SaveAs(Form("%d_tracks.png", nt));

        // Se vuoi liberare memoria:
        delete h1;
        delete h1fake;
        delete pad1;
        delete pad1fake;
        delete c1;
    }
}